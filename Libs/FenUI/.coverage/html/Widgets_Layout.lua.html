<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coverage Report: ADDON_DEV_LOCAL/Libs/FenUI - Widgets\Layout.lua</title>
    <style>
        :root {
            --bg: #1e1e2e;
            --surface: #313244;
            --text: #cdd6f4;
            --subtext: #a6adc8;
            --green: #a6e3a1;
            --yellow: #f9e2af;
            --red: #f38ba8;
            --blue: #89b4fa;
            --border: #45475a;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding: 2rem;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 {
            color: var(--blue);
            margin-bottom: 0.5rem;
            font-size: 1.75rem;
        }
        .timestamp {
            color: var(--subtext);
            font-size: 0.875rem;
            margin-bottom: 2rem;
        }
        .summary-card {
            background: var(--surface);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }
        .stat {
            text-align: center;
        }
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
        }
        .stat-label {
            color: var(--subtext);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .coverage-high { color: var(--green); }
        .coverage-medium { color: var(--yellow); }
        .coverage-low { color: var(--red); }
        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--surface);
            border-radius: 12px;
            overflow: hidden;
        }
        th, td {
            padding: 0.875rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        th {
            background: rgba(0,0,0,0.2);
            font-weight: 600;
            color: var(--subtext);
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
        }
        tr:hover { background: rgba(255,255,255,0.02); }
        tr:last-child td { border-bottom: none; }
        .file-link {
            color: var(--blue);
            text-decoration: none;
        }
        .file-link:hover { text-decoration: underline; }
        .progress-bar {
            width: 100px;
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        .text-right { text-align: right; }
        .file-detail {
            background: var(--surface);
            border-radius: 12px;
            margin-top: 2rem;
            overflow: hidden;
        }
        .file-header {
            padding: 1rem 1.5rem;
            background: rgba(0,0,0,0.2);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .file-name {
            font-family: 'Consolas', 'Monaco', monospace;
            color: var(--blue);
        }
        .code-view {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.875rem;
            overflow-x: auto;
        }
        .code-line {
            display: flex;
            min-height: 1.5rem;
        }
        .line-number {
            width: 50px;
            padding: 0 0.75rem;
            text-align: right;
            color: var(--subtext);
            user-select: none;
            flex-shrink: 0;
            background: rgba(0,0,0,0.1);
        }
        .line-content {
            flex: 1;
            padding: 0 1rem;
            white-space: pre;
        }
        .line-covered {
            background: rgba(166, 227, 161, 0.1);
        }
        .line-uncovered {
            background: rgba(243, 139, 168, 0.15);
        }
        .line-uncovered .line-number {
            background: rgba(243, 139, 168, 0.2);
            color: var(--red);
        }
        .nav { margin-bottom: 1rem; }
        .nav a {
            color: var(--blue);
            text-decoration: none;
            margin-right: 1rem;
        }
        .nav a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        
        <div class="nav">
            <a href="index.html">← Back to Summary</a>
        </div>
        
        <div class="file-detail">
            <div class="file-header">
                <span class="file-name">Widgets\Layout.lua</span>
                <span class="coverage-medium">77.6% (481/620 lines)</span>
            </div>
            <div class="code-view">
    
                <div class="code-line ">
                    <span class="line-number">1</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">2</span>
                    <span class="line-content">-- FenUI v2 - Layout Widget</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">3</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">4</span>
                    <span class="line-content">-- Foundational container primitive that unifies:</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">5</span>
                    <span class="line-content">-- - Borders (NineSlice)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">6</span>
                    <span class="line-content">-- - Backgrounds (color, image, gradient, conditional)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">7</span>
                    <span class="line-content">-- - Shadows (inner using Blizzard textures, drop shadows when available)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">8</span>
                    <span class="line-content">-- - Cell-based structure (single-cell or multi-row)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">9</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">10</span>
                    <span class="line-content">-- All other containers (Panel, Inset, Dialog, Card) build on this.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">11</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">12</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">13</span>
                    <span class="line-content">local FenUI = FenUI</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">14</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">15</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">16</span>
                    <span class="line-content">-- Shadow Textures</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">17</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">18</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">19</span>
                    <span class="line-content">-- Blizzard assets for inner shadow</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">20</span>
                    <span class="line-content">local INNER_SHADOW_TEXTURES = {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">21</span>
                    <span class="line-content">	corner = &quot;Interface\\Common\\ShadowOverlay-Corner&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">22</span>
                    <span class="line-content">	top = &quot;Interface\\Common\\ShadowOverlay-Top&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">23</span>
                    <span class="line-content">	bottom = &quot;Interface\\Common\\ShadowOverlay-Bottom&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">24</span>
                    <span class="line-content">	left = &quot;Interface\\Common\\ShadowOverlay-Left&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">25</span>
                    <span class="line-content">	right = &quot;Interface\\Common\\ShadowOverlay-Right&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">26</span>
                    <span class="line-content">}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">27</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">28</span>
                    <span class="line-content">-- Custom FenUI assets for drop shadows and glows</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">29</span>
                    <span class="line-content">-- Paths are resolved at runtime using FenUI.ADDON_PATH</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">30</span>
                    <span class="line-content">local DROP_SHADOW_TEXTURES -- Will be populated on first use</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">31</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">32</span>
                    <span class="line-content">local function GetDropShadowTextures()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">33</span>
                    <span class="line-content">	if not DROP_SHADOW_TEXTURES then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">34</span>
                    <span class="line-content">		local basePath = (FenUI.ADDON_PATH or &quot;Interface\\AddOns\\FenUI&quot;) .. &quot;\\Assets\\&quot;</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">35</span>
                    <span class="line-content">		DROP_SHADOW_TEXTURES = {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">36</span>
                    <span class="line-content">			soft = basePath .. &quot;shadow-soft-64&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">37</span>
                    <span class="line-content">			hard = basePath .. &quot;shadow-hard-64&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">38</span>
                    <span class="line-content">			glowSoft = basePath .. &quot;glow-soft-64&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">39</span>
                    <span class="line-content">			glowHard = basePath .. &quot;glow-hard-24&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">40</span>
                    <span class="line-content">		}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">41</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">42</span>
                    <span class="line-content">	return DROP_SHADOW_TEXTURES</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">43</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">44</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">45</span>
                    <span class="line-content">-- Default sizes</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">46</span>
                    <span class="line-content">local INNER_SHADOW_SIZE = 24 -- Blizzard default</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">47</span>
                    <span class="line-content">local DROP_SHADOW_SIZE = 16 -- Default drop shadow offset</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">48</span>
                    <span class="line-content">local GLOW_SIZE = 12 -- Default glow size</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">49</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">50</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">51</span>
                    <span class="line-content">-- Background Helper Functions</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">52</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">53</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">54</span>
                    <span class="line-content">--- Resolve a background config to its type and values</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">55</span>
                    <span class="line-content">---@param bgConfig string|table Background configuration</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">56</span>
                    <span class="line-content">---@return string type (&quot;color&quot;|&quot;image&quot;|&quot;gradient&quot;|&quot;conditional&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">57</span>
                    <span class="line-content">---@return table values Resolved values for the background type</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">58</span>
                    <span class="line-content">local function ResolveBackgroundConfig(bgConfig)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">59</span>
                    <span class="line-content">	if type(bgConfig) == &quot;string&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">60</span>
                    <span class="line-content">		-- Simple token string = color</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">61</span>
                    <span class="line-content">		return &quot;color&quot;, { token = bgConfig }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">62</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">63</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">64</span>
                    <span class="line-content">	if type(bgConfig) == &quot;table&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">65</span>
                    <span class="line-content">		if bgConfig.gradient then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">66</span>
                    <span class="line-content">			return &quot;gradient&quot;, bgConfig.gradient</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">67</span>
                    <span class="line-content">		elseif bgConfig.image then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">68</span>
                    <span class="line-content">			return &quot;image&quot;, bgConfig</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">69</span>
                    <span class="line-content">		elseif bgConfig.condition or bgConfig.variants then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">70</span>
                    <span class="line-content">			return &quot;conditional&quot;, bgConfig</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">71</span>
                    <span class="line-content">		elseif bgConfig.color then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">72</span>
                    <span class="line-content">			return &quot;color&quot;, { token = bgConfig.color, alpha = bgConfig.alpha }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">73</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">74</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">75</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">76</span>
                    <span class="line-content">	return &quot;none&quot;, {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">77</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">78</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">79</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">80</span>
                    <span class="line-content">-- Layout Mixin</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">81</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">82</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">83</span>
                    <span class="line-content">local LayoutMixin = {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">84</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">85</span>
                    <span class="line-content">function LayoutMixin:Init(config)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">86</span>
                    <span class="line-content">	self.config = config or {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">87</span>
                    <span class="line-content">	self.cells = {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">88</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">89</span>
                    <span class="line-content">	-- Create layers in order (bottom to top)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">90</span>
                    <span class="line-content">	self:CreateBackgroundLayer()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">91</span>
                    <span class="line-content">	self:CreateBorderLayer()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">92</span>
                    <span class="line-content">	self:CreateShadowLayer()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">93</span>
                    <span class="line-content">	self:CreateContentLayer()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">94</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">95</span>
                    <span class="line-content">	-- Apply size (supports responsive strings like &quot;50%&quot; and &quot;auto&quot;, and constraints)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">96</span>
                    <span class="line-content">	if</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">97</span>
                    <span class="line-content">		config.width</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">98</span>
                    <span class="line-content">		or config.height</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">99</span>
                    <span class="line-content">		or config.minWidth</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">100</span>
                    <span class="line-content">		or config.maxWidth</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">101</span>
                    <span class="line-content">		or config.minHeight</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">102</span>
                    <span class="line-content">		or config.maxHeight</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">103</span>
                    <span class="line-content">		or config.aspectRatio</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">104</span>
                    <span class="line-content">	then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">105</span>
                    <span class="line-content">		self:ApplySize(config.width, config.height, {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">106</span>
                    <span class="line-content">			minWidth = config.minWidth,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">107</span>
                    <span class="line-content">			maxWidth = config.maxWidth,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">108</span>
                    <span class="line-content">			minHeight = config.minHeight,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">109</span>
                    <span class="line-content">			maxHeight = config.maxHeight,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">110</span>
                    <span class="line-content">			aspectRatio = config.aspectRatio,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">111</span>
                    <span class="line-content">			aspectBase = config.aspectBase,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">112</span>
                    <span class="line-content">		})</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">113</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">114</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">115</span>
                    <span class="line-content">	-- Apply border FIRST (sets background inset for chamfered corners)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">116</span>
                    <span class="line-content">	if config.border then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">117</span>
                    <span class="line-content">		self:SetBorder(config.border)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">118</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">119</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">120</span>
                    <span class="line-content">	-- Apply background AFTER border (so inset is already set)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">121</span>
                    <span class="line-content">	if config.background then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">122</span>
                    <span class="line-content">		self:SetBackground(config.background)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">123</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">124</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">125</span>
                    <span class="line-content">	-- Apply shadow</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">126</span>
                    <span class="line-content">	if config.shadow then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">127</span>
                    <span class="line-content">		self:SetShadow(config.shadow)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">128</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">129</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">130</span>
                    <span class="line-content">	-- Create cells if multi-row or multi-column mode</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">131</span>
                    <span class="line-content">	if config.rows or config.cols then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">132</span>
                    <span class="line-content">		self:CreateCells()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">133</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">134</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">135</span>
                    <span class="line-content">	-- Hook content for auto-sizing</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">136</span>
                    <span class="line-content">	if self.isAutoSizing then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">137</span>
                    <span class="line-content">		FenUI.Utils:ObserveIntrinsicSize(self, self:GetContentFrame())</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">138</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">139</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">140</span>
                    <span class="line-content">	-- Setup animations and transitions</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">141</span>
                    <span class="line-content">	if config.transitions then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">142</span>
                    <span class="line-content">		FenUI.Animation:ApplyTransitions(self, config.transitions)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">143</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">144</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">145</span>
                    <span class="line-content">	if config.showAnimation or config.hideAnimation then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">146</span>
                    <span class="line-content">		self:SetupLifecycleAnimations()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">147</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">148</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">149</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">150</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">151</span>
                    <span class="line-content">-- Background Layer</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">152</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">153</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">154</span>
                    <span class="line-content">-- ARCHITECTURE: NineSlice Compatibility</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">155</span>
                    <span class="line-content">-- -------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">156</span>
                    <span class="line-content">-- In WoW 9.1.5+, frames using NineSlice borders cannot reliably render textures</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">157</span>
                    <span class="line-content">-- created directly on them. The NineSlice system takes over texture management.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">158</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">159</span>
                    <span class="line-content">-- SOLUTION: Create a dedicated child frame (bgFrame) at frameLevel 0.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">160</span>
                    <span class="line-content">-- The background texture lives on bgFrame, which renders BELOW the NineSlice</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">161</span>
                    <span class="line-content">-- border pieces. This follows Blizzard&#x27;s pattern in FlatPanelBackgroundTemplate.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">162</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">163</span>
                    <span class="line-content">-- Frame Hierarchy:</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">164</span>
                    <span class="line-content">--   Layout Frame (NineSlice border at level 1+)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">165</span>
                    <span class="line-content">--     └── bgFrame (frameLevel 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">166</span>
                    <span class="line-content">--           └── bgTexture (fills bgFrame)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">167</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">168</span>
                    <span class="line-content">-- DEFERRED SIZING FIX:</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">169</span>
                    <span class="line-content">-- Frames positioned via anchor points (TOPLEFT + BOTTOMRIGHT) have 0x0 size</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">170</span>
                    <span class="line-content">-- at Init() time. The OnSizeChanged handler reapplies background anchors</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">171</span>
                    <span class="line-content">-- when the frame receives its actual size.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">172</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">173</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">174</span>
                    <span class="line-content">-- Default inset for backgrounds when borders are applied</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">175</span>
                    <span class="line-content">-- We use a small 2px inset by default to ensure the background stays within</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">176</span>
                    <span class="line-content">-- the border&#x27;s visual edge without leaving large transparent gaps.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">177</span>
                    <span class="line-content">local DEFAULT_BG_INSET = 2</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">178</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">179</span>
                    <span class="line-content">--- Set the size of the layout (supports responsive units)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">180</span>
                    <span class="line-content">---@param width number|string</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">181</span>
                    <span class="line-content">---@param height number|string</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">182</span>
                    <span class="line-content">---@param constraints table|nil { minWidth, maxWidth, minHeight, maxHeight, aspectRatio, aspectBase }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">183</span>
                    <span class="line-content">function LayoutMixin:ApplySize(width, height, constraints)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">184</span>
                    <span class="line-content">	FenUI.Utils:ApplySize(self, width, height, constraints)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">185</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">186</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">187</span>
                    <span class="line-content">--- Internal method called when parent resizes (for responsive units)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">188</span>
                    <span class="line-content">function LayoutMixin:UpdateDynamicSize()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">189</span>
                    <span class="line-content">	FenUI.Utils:UpdateDynamicSize(self)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">190</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">191</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">192</span>
                    <span class="line-content">function LayoutMixin:CreateBackgroundLayer()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">193</span>
                    <span class="line-content">	-- Create a dedicated background frame</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">194</span>
                    <span class="line-content">	-- We don&#x27;t set a fixed frame level of 0, as that can put it behind the parent</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">195</span>
                    <span class="line-content">	-- frame&#x27;s background if the parent is at a high frame level.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">196</span>
                    <span class="line-content">	-- Instead, we let it inherit and we&#x27;ll manage layering via draw layers</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">197</span>
                    <span class="line-content">	-- or a slightly lower frame level than the parent.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">198</span>
                    <span class="line-content">	self.bgFrame = CreateFrame(&quot;Frame&quot;, nil, self)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">199</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">200</span>
                    <span class="line-content">	-- INSPECT SUPPORT: Enable mouse to be visible to GetMouseFoci(),</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">201</span>
                    <span class="line-content">	-- but disable clicking so it remains transparent to user interaction.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">202</span>
                    <span class="line-content">	self.bgFrame:EnableMouse(true)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">203</span>
                    <span class="line-content">	if self.bgFrame.SetMouseClickEnabled then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">204</span>
                    <span class="line-content">		self.bgFrame:SetMouseClickEnabled(false)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">205</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">206</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">207</span>
                    <span class="line-content">	-- Ensure it&#x27;s at the bottom of the parent&#x27;s internal stack</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">208</span>
                    <span class="line-content">	local parentLevel = self:GetFrameLevel()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">209</span>
                    <span class="line-content">	self.bgFrame:SetFrameLevel(math.max(0, parentLevel - 1))</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">210</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">211</span>
                    <span class="line-content">	-- Create the background texture on bgFrame (not self)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">212</span>
                    <span class="line-content">	self.bgTexture = self.bgFrame:CreateTexture(nil, &quot;BACKGROUND&quot;, nil, -8)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">213</span>
                    <span class="line-content">	self.bgTexture:SetAllPoints(self.bgFrame)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">214</span>
                    <span class="line-content">	self.bgTexture:Hide()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">215</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">216</span>
                    <span class="line-content">	-- Reapply background anchors when frame gets its actual size</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">217</span>
                    <span class="line-content">	-- This handles deferred sizing from anchor-based positioning</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">218</span>
                    <span class="line-content">	self:SetScript(&quot;OnSizeChanged&quot;, function(frame, width, height)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">219</span>
                    <span class="line-content">		if width &gt; 0 and height &gt; 0 and frame.bgFrame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">220</span>
                    <span class="line-content">			frame:ApplyBackgroundAnchors()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">221</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">222</span>
                    <span class="line-content">	end)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">223</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">224</span>
                    <span class="line-content">	-- Image background frame (for Image component)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">225</span>
                    <span class="line-content">	self.bgImageFrame = nil</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">226</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">227</span>
                    <span class="line-content">	-- Background inset (applied when border is set)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">228</span>
                    <span class="line-content">	-- Supports both number (symmetric) and table (asymmetric) values</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">229</span>
                    <span class="line-content">	self.bgInset = 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">230</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">231</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">232</span>
                    <span class="line-content">--- Set background inset</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">233</span>
                    <span class="line-content">---@param inset number Pixels to inset from edges</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">234</span>
                    <span class="line-content">function LayoutMixin:SetBackgroundInset(inset)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">235</span>
                    <span class="line-content">	self.bgInset = inset or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">236</span>
                    <span class="line-content">	self:ApplyBackgroundAnchors()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">237</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">238</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">239</span>
                    <span class="line-content">--- Apply background anchors with inset</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">240</span>
                    <span class="line-content">function LayoutMixin:ApplyBackgroundAnchors()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">241</span>
                    <span class="line-content">	-- NOTE: Systematic Background Anchoring (NineSlice Compatible)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">242</span>
                    <span class="line-content">	-- We position bgFrame (not bgTexture) inside the border area.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">243</span>
                    <span class="line-content">	-- bgTexture fills bgFrame via SetAllPoints.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">244</span>
                    <span class="line-content">	-- This avoids NineSlice conflicts by using a dedicated child frame.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">245</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">246</span>
                    <span class="line-content">	-- Support both single-value inset (number) and asymmetric inset (table)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">247</span>
                    <span class="line-content">	local inset = self.bgInset or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">248</span>
                    <span class="line-content">	local left, right, top, bottom</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">249</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">250</span>
                    <span class="line-content">	if type(inset) == &quot;table&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">251</span>
                    <span class="line-content">		left = inset.left or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">252</span>
                    <span class="line-content">		right = inset.right or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">253</span>
                    <span class="line-content">		top = inset.top or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">254</span>
                    <span class="line-content">		bottom = inset.bottom or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">255</span>
                    <span class="line-content">	else</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">256</span>
                    <span class="line-content">		left, right, top, bottom = inset, inset, inset, inset</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">257</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">258</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">259</span>
                    <span class="line-content">	-- Incorporate margins</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">260</span>
                    <span class="line-content">	local m = self:GetMargin()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">261</span>
                    <span class="line-content">	left = left + m.left</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">262</span>
                    <span class="line-content">	right = right + m.right</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">263</span>
                    <span class="line-content">	top = top + m.top</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">264</span>
                    <span class="line-content">	bottom = bottom + m.bottom</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">265</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">266</span>
                    <span class="line-content">	-- Position the background frame inside the border (asymmetric)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">267</span>
                    <span class="line-content">	self.bgFrame:ClearAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">268</span>
                    <span class="line-content">	self.bgFrame:SetPoint(&quot;TOPLEFT&quot;, self, &quot;TOPLEFT&quot;, left, -top)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">269</span>
                    <span class="line-content">	self.bgFrame:SetPoint(&quot;BOTTOMRIGHT&quot;, self, &quot;BOTTOMRIGHT&quot;, -right, bottom)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">270</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">271</span>
                    <span class="line-content">	-- bgTexture already fills bgFrame via SetAllPoints in CreateBackgroundLayer</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">272</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">273</span>
                    <span class="line-content">	-- Also apply to image background if present</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">274</span>
                    <span class="line-content">	if self.bgImageFrame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">275</span>
                    <span class="line-content">		self.bgImageFrame:ClearAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">276</span>
                    <span class="line-content">		self.bgImageFrame:SetPoint(&quot;TOPLEFT&quot;, self, &quot;TOPLEFT&quot;, left, -top)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">277</span>
                    <span class="line-content">		self.bgImageFrame:SetPoint(&quot;BOTTOMRIGHT&quot;, self, &quot;BOTTOMRIGHT&quot;, -right, bottom)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">278</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">279</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">280</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">281</span>
                    <span class="line-content">--- Set the background</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">282</span>
                    <span class="line-content">---@param bgConfig string|table Background configuration</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">283</span>
                    <span class="line-content">function LayoutMixin:SetBackground(bgConfig)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">284</span>
                    <span class="line-content">	if not bgConfig or bgConfig == false then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">285</span>
                    <span class="line-content">		self.bgTexture:Hide()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">286</span>
                    <span class="line-content">		if self.bgImageFrame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">287</span>
                    <span class="line-content">			self.bgImageFrame:Hide()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">288</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">289</span>
                    <span class="line-content">		-- Restore NineSlice center if we have one</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">290</span>
                    <span class="line-content">		if self.Center then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">291</span>
                    <span class="line-content">			self.Center:Show()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">292</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">293</span>
                    <span class="line-content">		return</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">294</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">295</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">296</span>
                    <span class="line-content">	-- Hide NineSlice&#x27;s built-in center when we use custom background</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">297</span>
                    <span class="line-content">	-- This prevents double-layering and edge bleeding</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">298</span>
                    <span class="line-content">	if self.Center then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">299</span>
                    <span class="line-content">		self.Center:Hide()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">300</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">301</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">302</span>
                    <span class="line-content">	local bgType, values = ResolveBackgroundConfig(bgConfig)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">303</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">304</span>
                    <span class="line-content">	if bgType == &quot;color&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">305</span>
                    <span class="line-content">		self:ApplyColorBackground(values)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">306</span>
                    <span class="line-content">	elseif bgType == &quot;gradient&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">307</span>
                    <span class="line-content">		self:ApplyGradientBackground(values)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">308</span>
                    <span class="line-content">	elseif bgType == &quot;image&quot; or bgType == &quot;conditional&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">309</span>
                    <span class="line-content">		self:ApplyImageBackground(bgConfig)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">310</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">311</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">312</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">313</span>
                    <span class="line-content">function LayoutMixin:ApplyColorBackground(values)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">314</span>
                    <span class="line-content">	-- Hide image background if present</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">315</span>
                    <span class="line-content">	if self.bgImageFrame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">316</span>
                    <span class="line-content">		self.bgImageFrame:Hide()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">317</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">318</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">319</span>
                    <span class="line-content">	-- Resolve the background color using FenUI&#x27;s token system.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">320</span>
                    <span class="line-content">	-- FenUI:GetColor(token) handles the multi-tier resolution:</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">321</span>
                    <span class="line-content">	-- 1. Active Theme overrides -&gt; 2. Semantic token -&gt; 3. Primitive value.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">322</span>
                    <span class="line-content">	local r, g, b, a = FenUI:GetColor(values.token)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">323</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">324</span>
                    <span class="line-content">	-- If a specific alpha was provided in the config, it overrides the token&#x27;s alpha.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">325</span>
                    <span class="line-content">	if values.alpha then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">326</span>
                    <span class="line-content">		a = values.alpha</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">327</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">328</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">329</span>
                    <span class="line-content">	-- Applying the final color to the dedicated bgFrame texture.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">330</span>
                    <span class="line-content">	-- Using a dedicated child frame at level 0 avoids rendering conflicts with NineSlice borders.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">331</span>
                    <span class="line-content">	self.bgTexture:SetColorTexture(r, g, b, a)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">332</span>
                    <span class="line-content">	self:ApplyBackgroundAnchors()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">333</span>
                    <span class="line-content">	self.bgTexture:Show()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">334</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">335</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">336</span>
                    <span class="line-content">function LayoutMixin:ApplyGradientBackground(values)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">337</span>
                    <span class="line-content">	-- Hide image background if present</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">338</span>
                    <span class="line-content">	if self.bgImageFrame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">339</span>
                    <span class="line-content">		self.bgImageFrame:Hide()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">340</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">341</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">342</span>
                    <span class="line-content">	-- Use white texture as base for gradient</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">343</span>
                    <span class="line-content">	self.bgTexture:SetColorTexture(1, 1, 1, 1)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">344</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">345</span>
                    <span class="line-content">	-- Resolve colors</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">346</span>
                    <span class="line-content">	local fromR, fromG, fromB, fromA = FenUI:GetColor(values.from)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">347</span>
                    <span class="line-content">	local toR, toG, toB, toA = FenUI:GetColor(values.to)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">348</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">349</span>
                    <span class="line-content">	local orientation = values.orientation or &quot;VERTICAL&quot;</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">350</span>
                    <span class="line-content">	self.bgTexture:SetGradient(</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">351</span>
                    <span class="line-content">		orientation,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">352</span>
                    <span class="line-content">		CreateColor(fromR, fromG, fromB, fromA or 1),</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">353</span>
                    <span class="line-content">		CreateColor(toR, toG, toB, toA or 1)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">354</span>
                    <span class="line-content">	)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">355</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">356</span>
                    <span class="line-content">	self:ApplyBackgroundAnchors()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">357</span>
                    <span class="line-content">	self.bgTexture:Show()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">358</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">359</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">360</span>
                    <span class="line-content">function LayoutMixin:ApplyImageBackground(bgConfig)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">361</span>
                    <span class="line-content">	-- Hide color texture</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">362</span>
                    <span class="line-content">	self.bgTexture:Hide()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">363</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">364</span>
                    <span class="line-content">	-- Create Image component if needed</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">365</span>
                    <span class="line-content">	if not self.bgImageFrame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">366</span>
                    <span class="line-content">		self.bgImageFrame = FenUI:CreateImage(self, {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">367</span>
                    <span class="line-content">			fill = true,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">368</span>
                    <span class="line-content">			drawLayer = &quot;BACKGROUND&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">369</span>
                    <span class="line-content">		})</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">370</span>
                    <span class="line-content">		self.bgImageFrame:SetFrameLevel(self:GetFrameLevel())</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">371</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">372</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">373</span>
                    <span class="line-content">	-- Configure the image</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">374</span>
                    <span class="line-content">	if bgConfig.condition or bgConfig.variants then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">375</span>
                    <span class="line-content">		self.bgImageFrame.config.condition = bgConfig.condition</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">376</span>
                    <span class="line-content">		self.bgImageFrame.config.variants = bgConfig.variants</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">377</span>
                    <span class="line-content">		self.bgImageFrame.config.fallback = bgConfig.fallback</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">378</span>
                    <span class="line-content">	elseif bgConfig.image then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">379</span>
                    <span class="line-content">		self.bgImageFrame.config.texture = bgConfig.image</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">380</span>
                    <span class="line-content">		self.bgImageFrame.config.condition = nil</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">381</span>
                    <span class="line-content">		self.bgImageFrame.config.variants = nil</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">382</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">383</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">384</span>
                    <span class="line-content">	if bgConfig.alpha then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">385</span>
                    <span class="line-content">		self.bgImageFrame:SetImageAlpha(bgConfig.alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">386</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">387</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">388</span>
                    <span class="line-content">	self.bgImageFrame:Refresh()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">389</span>
                    <span class="line-content">	self.bgImageFrame:Show()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">390</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">391</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">392</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">393</span>
                    <span class="line-content">-- Border Layer</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">394</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">395</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">396</span>
                    <span class="line-content">function LayoutMixin:CreateBorderLayer()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">397</span>
                    <span class="line-content">	-- Border will be applied via NineSlice</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">398</span>
                    <span class="line-content">	self.borderApplied = false</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">399</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">400</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">401</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">402</span>
                    <span class="line-content">-- Background Insets for Border Types</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">403</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">404</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">405</span>
                    <span class="line-content">-- WHY ASYMMETRIC INSETS:</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">406</span>
                    <span class="line-content">-- NineSlice borders like ButtonFrameTemplateNoPortrait have chamfered (angled)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">407</span>
                    <span class="line-content">-- corners. The background must be inset far enough to not &quot;bleed&quot; outside</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">408</span>
                    <span class="line-content">-- these chamfers, but not so far that it creates visible gaps on straight edges.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">409</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">410</span>
                    <span class="line-content">-- Blizzard uses this same pattern in FlatPanelBackgroundTemplate:</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">411</span>
                    <span class="line-content">--   TOPLEFT x=&quot;6&quot; y=&quot;-20&quot;, BOTTOMRIGHT x=&quot;-2&quot; y=&quot;2&quot;</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">412</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">413</span>
                    <span class="line-content">-- HOW TO ADD NEW BORDER TYPES:</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">414</span>
                    <span class="line-content">-- 1. Find the NineSlice layout name (e.g., &quot;Panel&quot;, &quot;Inset&quot;, &quot;Dialog&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">415</span>
                    <span class="line-content">-- 2. Test in-game to find the minimum inset that prevents bleeding</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">416</span>
                    <span class="line-content">-- 3. Add an entry: BorderName = { left = N, right = N, top = N, bottom = N }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">417</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">418</span>
                    <span class="line-content">-- HOW TO OVERRIDE FOR A SPECIFIC LAYOUT:</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">419</span>
                    <span class="line-content">-- Pass `backgroundInset` in the config table:</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">420</span>
                    <span class="line-content">--   FenUI:CreateLayout(parent, {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">421</span>
                    <span class="line-content">--       border = &quot;Panel&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">422</span>
                    <span class="line-content">--       backgroundInset = { left = 8, right = 4, top = 8, bottom = 4 },</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">423</span>
                    <span class="line-content">--   })</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">424</span>
                    <span class="line-content">--</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">425</span>
                    <span class="line-content">local BORDER_INSETS = {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">426</span>
                    <span class="line-content">	-- Legacy borders</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">427</span>
                    <span class="line-content">	Panel = { left = 6, right = 2, top = 6, bottom = 2 }, -- ButtonFrameTemplateNoPortrait (chamfered corners)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">428</span>
                    <span class="line-content">	Inset = { left = 2, right = 2, top = 2, bottom = 2 }, -- InsetFrameTemplate (small uniform edges)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">429</span>
                    <span class="line-content">	Dialog = { left = 6, right = 6, top = 6, bottom = 6 }, -- DialogBorderTemplate (symmetric chamfers)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">430</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">431</span>
                    <span class="line-content">	-- Modern borders (11.0+ style)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">432</span>
                    <span class="line-content">	Modern = { left = 6, right = 6, top = 6, bottom = 6 }, -- GenericMetal (clean symmetric edges)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">433</span>
                    <span class="line-content">	Metal = { left = 6, right = 6, top = 6, bottom = 6 }, -- Alias for Modern</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">434</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">435</span>
                    <span class="line-content">	-- Tooltip borders</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">436</span>
                    <span class="line-content">	Tooltip = { left = 8, right = 8, top = 10, bottom = 7 }, -- TooltipGluesLayout</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">437</span>
                    <span class="line-content">}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">438</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">439</span>
                    <span class="line-content">--- Set the border</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">440</span>
                    <span class="line-content">---@param borderKey string|false Border pack name or false to remove</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">441</span>
                    <span class="line-content">function LayoutMixin:SetBorder(borderKey)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">442</span>
                    <span class="line-content">	if not borderKey or borderKey == false then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">443</span>
                    <span class="line-content">		if self.borderApplied then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">444</span>
                    <span class="line-content">			FenUI:HideCustomBorder(self)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">445</span>
                    <span class="line-content">			-- Also check for legacy NineSlice hide if we support both</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">446</span>
                    <span class="line-content">			if FenUI.HideLayout then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">447</span>
                    <span class="line-content">				FenUI:HideLayout(self)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">448</span>
                    <span class="line-content">			end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">449</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">450</span>
                    <span class="line-content">		self.borderApplied = false</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">451</span>
                    <span class="line-content">		self:SetBackgroundInset(0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">452</span>
                    <span class="line-content">		return</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">453</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">454</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">455</span>
                    <span class="line-content">	-- 1. Try Custom Border Engine First (Intentional Custom)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">456</span>
                    <span class="line-content">	local pack = FenUI:GetBorderPack(borderKey)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">457</span>
                    <span class="line-content">	local margin = self:GetMargin()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">458</span>
                    <span class="line-content">	if pack then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">459</span>
                    <span class="line-content">		if FenUI:ApplyBorder(self, borderKey, self.config.borderToken, margin) then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">460</span>
                    <span class="line-content">			self.borderApplied = true</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">461</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">462</span>
                    <span class="line-content">			-- Apply pack-specific insets</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">463</span>
                    <span class="line-content">			local bgInset = self.config.backgroundInset or pack.bgInset or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">464</span>
                    <span class="line-content">			self:SetBackgroundInset(bgInset)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">465</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">466</span>
                    <span class="line-content">			-- Store padding adjustment if contentInset is provided</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">467</span>
                    <span class="line-content">			self.contentInset = pack.contentInset or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">468</span>
                    <span class="line-content">			return true</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">469</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">470</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">471</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">472</span>
                    <span class="line-content">	-- 2. Legacy Fallback: Blizzard NineSlice (if key is in FenUI.Layouts)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">473</span>
                    <span class="line-content">	if FenUI.ApplyLayout and (FenUI.Layouts[borderKey] or NineSliceLayouts[borderKey]) then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">474</span>
                    <span class="line-content">		FenUI:ApplyLayout(self, borderKey, self.config.textureKit, margin)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">475</span>
                    <span class="line-content">		self.borderApplied = true</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">476</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">477</span>
                    <span class="line-content">		local inset = self.config.backgroundInset</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">478</span>
                    <span class="line-content">		if inset == nil then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">479</span>
                    <span class="line-content">			inset = BORDER_INSETS[borderKey] or DEFAULT_BG_INSET</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">480</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">481</span>
                    <span class="line-content">		self:SetBackgroundInset(inset)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">482</span>
                    <span class="line-content">		return true</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">483</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">484</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">485</span>
                    <span class="line-content">	FenUI:Debug(&quot;SetBorder failed: unknown border key&quot;, borderKey)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">486</span>
                    <span class="line-content">	return false</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">487</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">488</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">489</span>
                    <span class="line-content">--- Get whether a border is applied</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">490</span>
                    <span class="line-content">---@return boolean</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">491</span>
                    <span class="line-content">function LayoutMixin:HasBorder()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">492</span>
                    <span class="line-content">	return self.borderApplied</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">493</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">494</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">495</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">496</span>
                    <span class="line-content">-- Shadow Layer (Inner Shadow using Blizzard textures)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">497</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">498</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">499</span>
                    <span class="line-content">function LayoutMixin:CreateShadowLayer()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">500</span>
                    <span class="line-content">	self.shadowTextures = nil</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">501</span>
                    <span class="line-content">	self.shadowType = nil</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">502</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">503</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">504</span>
                    <span class="line-content">--- Set shadow</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">505</span>
                    <span class="line-content">---@param shadowConfig string|table|boolean Shadow configuration</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">506</span>
                    <span class="line-content">function LayoutMixin:SetShadow(shadowConfig)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">507</span>
                    <span class="line-content">	if not shadowConfig or shadowConfig == false then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">508</span>
                    <span class="line-content">		self:HideShadow()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">509</span>
                    <span class="line-content">		return</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">510</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">511</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">512</span>
                    <span class="line-content">	-- Normalize config</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">513</span>
                    <span class="line-content">	local config = shadowConfig</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">514</span>
                    <span class="line-content">	if type(shadowConfig) == &quot;string&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">515</span>
                    <span class="line-content">		config = { type = shadowConfig }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">516</span>
                    <span class="line-content">	elseif shadowConfig == true then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">517</span>
                    <span class="line-content">		config = { type = &quot;inner&quot; }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">518</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">519</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">520</span>
                    <span class="line-content">	local shadowType = config.type or &quot;inner&quot;</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">521</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">522</span>
                    <span class="line-content">	if shadowType == &quot;inner&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">523</span>
                    <span class="line-content">		self:ApplyInnerShadow(config)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">524</span>
                    <span class="line-content">	elseif shadowType == &quot;soft&quot; or shadowType == &quot;hard&quot; or shadowType == &quot;glow&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">525</span>
                    <span class="line-content">		-- Drop shadows - requires custom textures (placeholder for now)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">526</span>
                    <span class="line-content">		self:ApplyDropShadow(config)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">527</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">528</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">529</span>
                    <span class="line-content">	self.shadowType = shadowType</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">530</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">531</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">532</span>
                    <span class="line-content">function LayoutMixin:ApplyInnerShadow(config)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">533</span>
                    <span class="line-content">	-- Create shadow textures if needed</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">534</span>
                    <span class="line-content">	if not self.shadowTextures then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">535</span>
                    <span class="line-content">		self.shadowTextures = {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">536</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">537</span>
                    <span class="line-content">		-- Create 8 textures: 4 corners + 4 edges</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">538</span>
                    <span class="line-content">		local size = config.size or INNER_SHADOW_SIZE</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">539</span>
                    <span class="line-content">		local alpha = config.alpha or 0.5</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">540</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">541</span>
                    <span class="line-content">		-- Top-left corner</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">542</span>
                    <span class="line-content">		self.shadowTextures.topLeft = self:CreateTexture(nil, &quot;OVERLAY&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">543</span>
                    <span class="line-content">		self.shadowTextures.topLeft:SetTexture(INNER_SHADOW_TEXTURES.corner)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">544</span>
                    <span class="line-content">		self.shadowTextures.topLeft:SetSize(size, size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">545</span>
                    <span class="line-content">		self.shadowTextures.topLeft:SetPoint(&quot;TOPLEFT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">546</span>
                    <span class="line-content">		self.shadowTextures.topLeft:SetAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">547</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">548</span>
                    <span class="line-content">		-- Top-right corner (rotated)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">549</span>
                    <span class="line-content">		self.shadowTextures.topRight = self:CreateTexture(nil, &quot;OVERLAY&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">550</span>
                    <span class="line-content">		self.shadowTextures.topRight:SetTexture(INNER_SHADOW_TEXTURES.corner)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">551</span>
                    <span class="line-content">		self.shadowTextures.topRight:SetSize(size, size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">552</span>
                    <span class="line-content">		self.shadowTextures.topRight:SetPoint(&quot;TOPRIGHT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">553</span>
                    <span class="line-content">		self.shadowTextures.topRight:SetTexCoord(0, 1, 1, 1, 0, 0, 1, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">554</span>
                    <span class="line-content">		self.shadowTextures.topRight:SetAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">555</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">556</span>
                    <span class="line-content">		-- Bottom-left corner (rotated)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">557</span>
                    <span class="line-content">		self.shadowTextures.bottomLeft = self:CreateTexture(nil, &quot;OVERLAY&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">558</span>
                    <span class="line-content">		self.shadowTextures.bottomLeft:SetTexture(INNER_SHADOW_TEXTURES.corner)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">559</span>
                    <span class="line-content">		self.shadowTextures.bottomLeft:SetSize(size, size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">560</span>
                    <span class="line-content">		self.shadowTextures.bottomLeft:SetPoint(&quot;BOTTOMLEFT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">561</span>
                    <span class="line-content">		self.shadowTextures.bottomLeft:SetTexCoord(1, 0, 0, 0, 1, 1, 0, 1)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">562</span>
                    <span class="line-content">		self.shadowTextures.bottomLeft:SetAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">563</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">564</span>
                    <span class="line-content">		-- Bottom-right corner (rotated)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">565</span>
                    <span class="line-content">		self.shadowTextures.bottomRight = self:CreateTexture(nil, &quot;OVERLAY&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">566</span>
                    <span class="line-content">		self.shadowTextures.bottomRight:SetTexture(INNER_SHADOW_TEXTURES.corner)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">567</span>
                    <span class="line-content">		self.shadowTextures.bottomRight:SetSize(size, size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">568</span>
                    <span class="line-content">		self.shadowTextures.bottomRight:SetPoint(&quot;BOTTOMRIGHT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">569</span>
                    <span class="line-content">		self.shadowTextures.bottomRight:SetTexCoord(1, 1, 1, 0, 0, 1, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">570</span>
                    <span class="line-content">		self.shadowTextures.bottomRight:SetAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">571</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">572</span>
                    <span class="line-content">		-- Top edge</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">573</span>
                    <span class="line-content">		self.shadowTextures.top = self:CreateTexture(nil, &quot;OVERLAY&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">574</span>
                    <span class="line-content">		self.shadowTextures.top:SetTexture(INNER_SHADOW_TEXTURES.top)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">575</span>
                    <span class="line-content">		self.shadowTextures.top:SetHeight(size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">576</span>
                    <span class="line-content">		self.shadowTextures.top:SetPoint(&quot;TOPLEFT&quot;, self.shadowTextures.topLeft, &quot;TOPRIGHT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">577</span>
                    <span class="line-content">		self.shadowTextures.top:SetPoint(&quot;TOPRIGHT&quot;, self.shadowTextures.topRight, &quot;TOPLEFT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">578</span>
                    <span class="line-content">		self.shadowTextures.top:SetAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">579</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">580</span>
                    <span class="line-content">		-- Bottom edge</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">581</span>
                    <span class="line-content">		self.shadowTextures.bottom = self:CreateTexture(nil, &quot;OVERLAY&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">582</span>
                    <span class="line-content">		self.shadowTextures.bottom:SetTexture(INNER_SHADOW_TEXTURES.bottom)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">583</span>
                    <span class="line-content">		self.shadowTextures.bottom:SetHeight(size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">584</span>
                    <span class="line-content">		self.shadowTextures.bottom:SetPoint(&quot;BOTTOMLEFT&quot;, self.shadowTextures.bottomLeft, &quot;BOTTOMRIGHT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">585</span>
                    <span class="line-content">		self.shadowTextures.bottom:SetPoint(&quot;BOTTOMRIGHT&quot;, self.shadowTextures.bottomRight, &quot;BOTTOMLEFT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">586</span>
                    <span class="line-content">		self.shadowTextures.bottom:SetAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">587</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">588</span>
                    <span class="line-content">		-- Left edge</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">589</span>
                    <span class="line-content">		self.shadowTextures.left = self:CreateTexture(nil, &quot;OVERLAY&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">590</span>
                    <span class="line-content">		self.shadowTextures.left:SetTexture(INNER_SHADOW_TEXTURES.left)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">591</span>
                    <span class="line-content">		self.shadowTextures.left:SetWidth(size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">592</span>
                    <span class="line-content">		self.shadowTextures.left:SetPoint(&quot;TOPLEFT&quot;, self.shadowTextures.topLeft, &quot;BOTTOMLEFT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">593</span>
                    <span class="line-content">		self.shadowTextures.left:SetPoint(&quot;BOTTOMLEFT&quot;, self.shadowTextures.bottomLeft, &quot;TOPLEFT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">594</span>
                    <span class="line-content">		self.shadowTextures.left:SetAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">595</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">596</span>
                    <span class="line-content">		-- Right edge</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">597</span>
                    <span class="line-content">		self.shadowTextures.right = self:CreateTexture(nil, &quot;OVERLAY&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">598</span>
                    <span class="line-content">		self.shadowTextures.right:SetTexture(INNER_SHADOW_TEXTURES.right)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">599</span>
                    <span class="line-content">		self.shadowTextures.right:SetWidth(size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">600</span>
                    <span class="line-content">		self.shadowTextures.right:SetPoint(&quot;TOPRIGHT&quot;, self.shadowTextures.topRight, &quot;BOTTOMRIGHT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">601</span>
                    <span class="line-content">		self.shadowTextures.right:SetPoint(&quot;BOTTOMRIGHT&quot;, self.shadowTextures.bottomRight, &quot;TOPRIGHT&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">602</span>
                    <span class="line-content">		self.shadowTextures.right:SetAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">603</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">604</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">605</span>
                    <span class="line-content">	-- Show all shadow textures</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">606</span>
                    <span class="line-content">	for _, tex in pairs(self.shadowTextures) do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">607</span>
                    <span class="line-content">		tex:Show()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">608</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">609</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">610</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">611</span>
                    <span class="line-content">function LayoutMixin:ApplyDropShadow(config)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">612</span>
                    <span class="line-content">	local shadowType = config.type or &quot;soft&quot;</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">613</span>
                    <span class="line-content">	local isGlow = shadowType == &quot;glow&quot; or shadowType == &quot;glowHard&quot;</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">614</span>
                    <span class="line-content">	local textures = GetDropShadowTextures()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">615</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">616</span>
                    <span class="line-content">	-- Select texture based on type</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">617</span>
                    <span class="line-content">	local texture</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">618</span>
                    <span class="line-content">	local size</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">619</span>
                    <span class="line-content">	if shadowType == &quot;soft&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">620</span>
                    <span class="line-content">		texture = textures.soft</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">621</span>
                    <span class="line-content">		size = config.size or 16</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">622</span>
                    <span class="line-content">	elseif shadowType == &quot;hard&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">623</span>
                    <span class="line-content">		texture = textures.hard</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">624</span>
                    <span class="line-content">		size = config.size or 12</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">625</span>
                    <span class="line-content">	elseif shadowType == &quot;glow&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">626</span>
                    <span class="line-content">		texture = textures.glowSoft</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">627</span>
                    <span class="line-content">		size = config.size or 16</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">628</span>
                    <span class="line-content">	elseif shadowType == &quot;glowHard&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">629</span>
                    <span class="line-content">		texture = textures.glowHard</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">630</span>
                    <span class="line-content">		size = config.size or 8</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">631</span>
                    <span class="line-content">	else</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">632</span>
                    <span class="line-content">		texture = textures.soft</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">633</span>
                    <span class="line-content">		size = config.size or 16</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">634</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">635</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">636</span>
                    <span class="line-content">	local alpha = config.alpha or (isGlow and 0.8 or 0.6)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">637</span>
                    <span class="line-content">	local offsetX = config.offsetX or (isGlow and 0 or 4)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">638</span>
                    <span class="line-content">	local offsetY = config.offsetY or (isGlow and 0 or -4)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">639</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">640</span>
                    <span class="line-content">	-- Create shadow frame if needed (sits behind the main frame)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">641</span>
                    <span class="line-content">	if not self.dropShadowFrame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">642</span>
                    <span class="line-content">		self.dropShadowFrame = CreateFrame(&quot;Frame&quot;, nil, self:GetParent())</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">643</span>
                    <span class="line-content">		self.dropShadowFrame:SetFrameLevel(math.max(1, self:GetFrameLevel() - 1))</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">644</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">645</span>
                    <span class="line-content">		-- Create 9 textures for proper scaling: 4 corners, 4 edges, 1 center</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">646</span>
                    <span class="line-content">		self.dropShadowTextures = {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">647</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">648</span>
                    <span class="line-content">		-- Corners (use full texture, positioned at corners)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">649</span>
                    <span class="line-content">		for _, corner in ipairs({ &quot;TopLeft&quot;, &quot;TopRight&quot;, &quot;BottomLeft&quot;, &quot;BottomRight&quot; }) do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">650</span>
                    <span class="line-content">			local tex = self.dropShadowFrame:CreateTexture(nil, &quot;BACKGROUND&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">651</span>
                    <span class="line-content">			tex:SetBlendMode(isGlow and &quot;ADD&quot; or &quot;BLEND&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">652</span>
                    <span class="line-content">			self.dropShadowTextures[corner] = tex</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">653</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">654</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">655</span>
                    <span class="line-content">		-- Edges (stretched)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">656</span>
                    <span class="line-content">		for _, edge in ipairs({ &quot;Top&quot;, &quot;Bottom&quot;, &quot;Left&quot;, &quot;Right&quot; }) do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">657</span>
                    <span class="line-content">			local tex = self.dropShadowFrame:CreateTexture(nil, &quot;BACKGROUND&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">658</span>
                    <span class="line-content">			tex:SetBlendMode(isGlow and &quot;ADD&quot; or &quot;BLEND&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">659</span>
                    <span class="line-content">			self.dropShadowTextures[edge] = tex</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">660</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">661</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">662</span>
                    <span class="line-content">		-- Center (optional, for very soft shadows)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">663</span>
                    <span class="line-content">		self.dropShadowTextures.Center = self.dropShadowFrame:CreateTexture(nil, &quot;BACKGROUND&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">664</span>
                    <span class="line-content">		self.dropShadowTextures.Center:SetBlendMode(isGlow and &quot;ADD&quot; or &quot;BLEND&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">665</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">666</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">667</span>
                    <span class="line-content">	-- Update frame position relative to main frame</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">668</span>
                    <span class="line-content">	local m = self:GetMargin()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">669</span>
                    <span class="line-content">	self.dropShadowFrame:ClearAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">670</span>
                    <span class="line-content">	self.dropShadowFrame:SetPoint(&quot;TOPLEFT&quot;, self, &quot;TOPLEFT&quot;, m.left - size + offsetX, -(m.top - size + offsetY))</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">671</span>
                    <span class="line-content">	self.dropShadowFrame:SetPoint(</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">672</span>
                    <span class="line-content">		&quot;BOTTOMRIGHT&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">673</span>
                    <span class="line-content">		self,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">674</span>
                    <span class="line-content">		&quot;BOTTOMRIGHT&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">675</span>
                    <span class="line-content">		-(m.right - size + offsetX),</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">676</span>
                    <span class="line-content">		m.bottom - size + offsetY</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">677</span>
                    <span class="line-content">	)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">678</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">679</span>
                    <span class="line-content">	-- Apply tint color for glows</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">680</span>
                    <span class="line-content">	local r, g, b = 0, 0, 0 -- Default black for shadows</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">681</span>
                    <span class="line-content">	if isGlow and config.color then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">682</span>
                    <span class="line-content">		r, g, b = FenUI:GetColorRGB(config.color)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">683</span>
                    <span class="line-content">	elseif isGlow then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">684</span>
                    <span class="line-content">		r, g, b = FenUI:GetColorRGB(&quot;gold500&quot;) -- Default gold glow</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">685</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">686</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">687</span>
                    <span class="line-content">	-- Configure all textures</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">688</span>
                    <span class="line-content">	for name, tex in pairs(self.dropShadowTextures) do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">689</span>
                    <span class="line-content">		tex:SetTexture(texture)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">690</span>
                    <span class="line-content">		tex:SetVertexColor(r, g, b, alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">691</span>
                    <span class="line-content">		tex:SetSize(size, size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">692</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">693</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">694</span>
                    <span class="line-content">	-- Position corners</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">695</span>
                    <span class="line-content">	self.dropShadowTextures.TopLeft:SetPoint(&quot;TOPLEFT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">696</span>
                    <span class="line-content">	self.dropShadowTextures.TopLeft:SetTexCoord(0, 0.5, 0, 0.5)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">697</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">698</span>
                    <span class="line-content">	self.dropShadowTextures.TopRight:SetPoint(&quot;TOPRIGHT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">699</span>
                    <span class="line-content">	self.dropShadowTextures.TopRight:SetTexCoord(0.5, 1, 0, 0.5)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">700</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">701</span>
                    <span class="line-content">	self.dropShadowTextures.BottomLeft:SetPoint(&quot;BOTTOMLEFT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">702</span>
                    <span class="line-content">	self.dropShadowTextures.BottomLeft:SetTexCoord(0, 0.5, 0.5, 1)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">703</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">704</span>
                    <span class="line-content">	self.dropShadowTextures.BottomRight:SetPoint(&quot;BOTTOMRIGHT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">705</span>
                    <span class="line-content">	self.dropShadowTextures.BottomRight:SetTexCoord(0.5, 1, 0.5, 1)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">706</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">707</span>
                    <span class="line-content">	-- Position edges (stretched between corners)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">708</span>
                    <span class="line-content">	self.dropShadowTextures.Top:SetPoint(&quot;TOPLEFT&quot;, self.dropShadowTextures.TopLeft, &quot;TOPRIGHT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">709</span>
                    <span class="line-content">	self.dropShadowTextures.Top:SetPoint(&quot;TOPRIGHT&quot;, self.dropShadowTextures.TopRight, &quot;TOPLEFT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">710</span>
                    <span class="line-content">	self.dropShadowTextures.Top:SetHeight(size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">711</span>
                    <span class="line-content">	self.dropShadowTextures.Top:SetTexCoord(0.5, 0.5, 0, 0.5) -- Vertical slice from center</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">712</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">713</span>
                    <span class="line-content">	self.dropShadowTextures.Bottom:SetPoint(&quot;BOTTOMLEFT&quot;, self.dropShadowTextures.BottomLeft, &quot;BOTTOMRIGHT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">714</span>
                    <span class="line-content">	self.dropShadowTextures.Bottom:SetPoint(&quot;BOTTOMRIGHT&quot;, self.dropShadowTextures.BottomRight, &quot;BOTTOMLEFT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">715</span>
                    <span class="line-content">	self.dropShadowTextures.Bottom:SetHeight(size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">716</span>
                    <span class="line-content">	self.dropShadowTextures.Bottom:SetTexCoord(0.5, 0.5, 0.5, 1)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">717</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">718</span>
                    <span class="line-content">	self.dropShadowTextures.Left:SetPoint(&quot;TOPLEFT&quot;, self.dropShadowTextures.TopLeft, &quot;BOTTOMLEFT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">719</span>
                    <span class="line-content">	self.dropShadowTextures.Left:SetPoint(&quot;BOTTOMLEFT&quot;, self.dropShadowTextures.BottomLeft, &quot;TOPLEFT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">720</span>
                    <span class="line-content">	self.dropShadowTextures.Left:SetWidth(size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">721</span>
                    <span class="line-content">	self.dropShadowTextures.Left:SetTexCoord(0, 0.5, 0.5, 0.5) -- Horizontal slice from center</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">722</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">723</span>
                    <span class="line-content">	self.dropShadowTextures.Right:SetPoint(&quot;TOPRIGHT&quot;, self.dropShadowTextures.TopRight, &quot;BOTTOMRIGHT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">724</span>
                    <span class="line-content">	self.dropShadowTextures.Right:SetPoint(&quot;BOTTOMRIGHT&quot;, self.dropShadowTextures.BottomRight, &quot;TOPRIGHT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">725</span>
                    <span class="line-content">	self.dropShadowTextures.Right:SetWidth(size)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">726</span>
                    <span class="line-content">	self.dropShadowTextures.Right:SetTexCoord(0.5, 1, 0.5, 0.5)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">727</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">728</span>
                    <span class="line-content">	-- Center fill (very subtle, optional)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">729</span>
                    <span class="line-content">	self.dropShadowTextures.Center:SetPoint(&quot;TOPLEFT&quot;, self.dropShadowTextures.TopLeft, &quot;BOTTOMRIGHT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">730</span>
                    <span class="line-content">	self.dropShadowTextures.Center:SetPoint(&quot;BOTTOMRIGHT&quot;, self.dropShadowTextures.BottomRight, &quot;TOPLEFT&quot;, 0, 0)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">731</span>
                    <span class="line-content">	self.dropShadowTextures.Center:SetTexCoord(0.45, 0.55, 0.45, 0.55) -- Center slice</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">732</span>
                    <span class="line-content">	self.dropShadowTextures.Center:SetAlpha(alpha * 0.3) -- Much more subtle</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">733</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">734</span>
                    <span class="line-content">	self.dropShadowFrame:Show()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">735</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">736</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">737</span>
                    <span class="line-content">function LayoutMixin:HideShadow()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">738</span>
                    <span class="line-content">	-- Hide inner shadow textures</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">739</span>
                    <span class="line-content">	if self.shadowTextures then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">740</span>
                    <span class="line-content">		for _, tex in pairs(self.shadowTextures) do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">741</span>
                    <span class="line-content">			tex:Hide()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">742</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">743</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">744</span>
                    <span class="line-content">	-- Hide drop shadow frame</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">745</span>
                    <span class="line-content">	if self.dropShadowFrame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">746</span>
                    <span class="line-content">		self.dropShadowFrame:Hide()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">747</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">748</span>
                    <span class="line-content">	self.shadowType = nil</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">749</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">750</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">751</span>
                    <span class="line-content">--- Set shadow alpha</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">752</span>
                    <span class="line-content">---@param alpha number 0-1</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">753</span>
                    <span class="line-content">function LayoutMixin:SetShadowAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">754</span>
                    <span class="line-content">	-- Inner shadow textures</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">755</span>
                    <span class="line-content">	if self.shadowTextures then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">756</span>
                    <span class="line-content">		for _, tex in pairs(self.shadowTextures) do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">757</span>
                    <span class="line-content">			tex:SetAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">758</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">759</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">760</span>
                    <span class="line-content">	-- Drop shadow textures</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">761</span>
                    <span class="line-content">	if self.dropShadowTextures then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">762</span>
                    <span class="line-content">		for name, tex in pairs(self.dropShadowTextures) do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">763</span>
                    <span class="line-content">			if name == &quot;Center&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">764</span>
                    <span class="line-content">				tex:SetAlpha(alpha * 0.3) -- Center stays more subtle</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">765</span>
                    <span class="line-content">			else</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">766</span>
                    <span class="line-content">				tex:SetAlpha(alpha)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">767</span>
                    <span class="line-content">			end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">768</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">769</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">770</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">771</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">772</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">773</span>
                    <span class="line-content">-- Content Layer (Single-cell or Multi-row)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">774</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">775</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">776</span>
                    <span class="line-content">function LayoutMixin:CreateContentLayer()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">777</span>
                    <span class="line-content">	-- Content frame for single-cell mode</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">778</span>
                    <span class="line-content">	self.contentFrame = nil</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">779</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">780</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">781</span>
                    <span class="line-content">--- Get the content frame (creates if needed for single-cell mode)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">782</span>
                    <span class="line-content">---@return Frame</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">783</span>
                    <span class="line-content">function LayoutMixin:GetContentFrame()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">784</span>
                    <span class="line-content">	if not self.contentFrame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">785</span>
                    <span class="line-content">		self.contentFrame = CreateFrame(&quot;Frame&quot;, nil, self)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">786</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">787</span>
                    <span class="line-content">		local p = self:GetPadding()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">788</span>
                    <span class="line-content">		local m = self:GetMargin()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">789</span>
                    <span class="line-content">		self.contentFrame:SetPoint(&quot;TOPLEFT&quot;, m.left + p.left, -(m.top + p.top))</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">790</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">791</span>
                    <span class="line-content">		-- In auto-sizing mode, we don&#x27;t anchor the bottom-right to the parent,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">792</span>
                    <span class="line-content">		-- as that would create a circular dependency.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">793</span>
                    <span class="line-content">		if self.dynamicSize and (self.dynamicSize.width == &quot;auto&quot; or self.dynamicSize.height == &quot;auto&quot;) then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">794</span>
                    <span class="line-content">			-- Let children define the size</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">795</span>
                    <span class="line-content">		else</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">796</span>
                    <span class="line-content">			self.contentFrame:SetPoint(&quot;BOTTOMRIGHT&quot;, -(m.right + p.right), m.bottom + p.bottom)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">797</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">798</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">799</span>
                    <span class="line-content">	return self.contentFrame</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">800</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">801</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">802</span>
                    <span class="line-content">--- Set content for single-cell mode</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">803</span>
                    <span class="line-content">---@param frame Frame Frame to place in content area</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">804</span>
                    <span class="line-content">function LayoutMixin:SetContent(frame)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">805</span>
                    <span class="line-content">	if not frame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">806</span>
                    <span class="line-content">		return</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">807</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">808</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">809</span>
                    <span class="line-content">	local content = self:GetContentFrame()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">810</span>
                    <span class="line-content">	frame:SetParent(content)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">811</span>
                    <span class="line-content">	frame:ClearAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">812</span>
                    <span class="line-content">	frame:SetAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">813</span>
                    <span class="line-content">	frame:Show()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">814</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">815</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">816</span>
                    <span class="line-content">--- Get margin values (from config or tokens)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">817</span>
                    <span class="line-content">--- Supports: number (symmetric), string (token), table { top, bottom, left, right }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">818</span>
                    <span class="line-content">--- Individual overrides: marginTop, marginBottom, marginLeft, marginRight</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">819</span>
                    <span class="line-content">---@return table { top, bottom, left, right }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">820</span>
                    <span class="line-content">function LayoutMixin:GetMargin()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">821</span>
                    <span class="line-content">	local config = self.config</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">822</span>
                    <span class="line-content">	local margin = config.margin</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">823</span>
                    <span class="line-content">	local base = { top = 0, bottom = 0, left = 0, right = 0 }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">824</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">825</span>
                    <span class="line-content">	if margin then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">826</span>
                    <span class="line-content">		if type(margin) == &quot;number&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">827</span>
                    <span class="line-content">			base = { top = margin, bottom = margin, left = margin, right = margin }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">828</span>
                    <span class="line-content">		elseif type(margin) == &quot;string&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">829</span>
                    <span class="line-content">			local val = FenUI:GetSpacing(margin)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">830</span>
                    <span class="line-content">			if val == 0 then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">831</span>
                    <span class="line-content">				val = FenUI:GetLayout(margin)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">832</span>
                    <span class="line-content">			end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">833</span>
                    <span class="line-content">			base = { top = val, bottom = val, left = val, right = val }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">834</span>
                    <span class="line-content">		elseif type(margin) == &quot;table&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">835</span>
                    <span class="line-content">			base = {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">836</span>
                    <span class="line-content">				top = margin.top or 0,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">837</span>
                    <span class="line-content">				bottom = margin.bottom or 0,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">838</span>
                    <span class="line-content">				left = margin.left or 0,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">839</span>
                    <span class="line-content">				right = margin.right or 0,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">840</span>
                    <span class="line-content">			}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">841</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">842</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">843</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">844</span>
                    <span class="line-content">	-- Apply individual side overrides</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">845</span>
                    <span class="line-content">	if config.marginTop then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">846</span>
                    <span class="line-content">		base.top = FenUI:GetSpacing(config.marginTop)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">847</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">848</span>
                    <span class="line-content">	if config.marginBottom then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">849</span>
                    <span class="line-content">		base.bottom = FenUI:GetSpacing(config.marginBottom)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">850</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">851</span>
                    <span class="line-content">	if config.marginLeft then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">852</span>
                    <span class="line-content">		base.left = FenUI:GetSpacing(config.marginLeft)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">853</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">854</span>
                    <span class="line-content">	if config.marginRight then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">855</span>
                    <span class="line-content">		base.right = FenUI:GetSpacing(config.marginRight)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">856</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">857</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">858</span>
                    <span class="line-content">	return base</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">859</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">860</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">861</span>
                    <span class="line-content">--- Get padding values (from config or tokens)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">862</span>
                    <span class="line-content">--- Supports: number (symmetric), string (token), table { top, bottom, left, right }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">863</span>
                    <span class="line-content">--- Individual overrides: paddingTop, paddingBottom, paddingLeft, paddingRight</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">864</span>
                    <span class="line-content">---@return table { top, bottom, left, right }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">865</span>
                    <span class="line-content">function LayoutMixin:GetPadding()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">866</span>
                    <span class="line-content">	local config = self.config</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">867</span>
                    <span class="line-content">	local padding = config.padding</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">868</span>
                    <span class="line-content">	local base = { top = 0, bottom = 0, left = 0, right = 0 }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">869</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">870</span>
                    <span class="line-content">	if padding then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">871</span>
                    <span class="line-content">		if type(padding) == &quot;number&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">872</span>
                    <span class="line-content">			base = { top = padding, bottom = padding, left = padding, right = padding }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">873</span>
                    <span class="line-content">		elseif type(padding) == &quot;string&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">874</span>
                    <span class="line-content">			local val = FenUI:GetSpacing(padding)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">875</span>
                    <span class="line-content">			if val == 0 then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">876</span>
                    <span class="line-content">				val = FenUI:GetLayout(padding)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">877</span>
                    <span class="line-content">			end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">878</span>
                    <span class="line-content">			base = { top = val, bottom = val, left = val, right = val }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">879</span>
                    <span class="line-content">		elseif type(padding) == &quot;table&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">880</span>
                    <span class="line-content">			base = {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">881</span>
                    <span class="line-content">				top = padding.top or 0,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">882</span>
                    <span class="line-content">				bottom = padding.bottom or 0,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">883</span>
                    <span class="line-content">				left = padding.left or 0,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">884</span>
                    <span class="line-content">				right = padding.right or 0,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">885</span>
                    <span class="line-content">			}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">886</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">887</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">888</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">889</span>
                    <span class="line-content">	-- Apply individual side overrides</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">890</span>
                    <span class="line-content">	if config.paddingTop then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">891</span>
                    <span class="line-content">		base.top = FenUI:GetSpacing(config.paddingTop)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">892</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">893</span>
                    <span class="line-content">	if config.paddingBottom then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">894</span>
                    <span class="line-content">		base.bottom = FenUI:GetSpacing(config.paddingBottom)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">895</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">896</span>
                    <span class="line-content">	if config.paddingLeft then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">897</span>
                    <span class="line-content">		base.left = FenUI:GetSpacing(config.paddingLeft)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">898</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">899</span>
                    <span class="line-content">	if config.paddingRight then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">900</span>
                    <span class="line-content">		base.right = FenUI:GetSpacing(config.paddingRight)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">901</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">902</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">903</span>
                    <span class="line-content">	-- Add border-mandated content inset</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">904</span>
                    <span class="line-content">	local offset = self.contentInset or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">905</span>
                    <span class="line-content">	return {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">906</span>
                    <span class="line-content">		top = base.top + offset,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">907</span>
                    <span class="line-content">		bottom = base.bottom + offset,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">908</span>
                    <span class="line-content">		left = base.left + offset,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">909</span>
                    <span class="line-content">		right = base.right + offset,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">910</span>
                    <span class="line-content">	}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">911</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">912</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">913</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">914</span>
                    <span class="line-content">-- Multi-Row Cell System</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">915</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">916</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">917</span>
                    <span class="line-content">function LayoutMixin:CreateCells()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">918</span>
                    <span class="line-content">	local rowDefs = self.config.rows</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">919</span>
                    <span class="line-content">	local colDefs = self.config.cols</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">920</span>
                    <span class="line-content">	local defs = rowDefs or colDefs</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">921</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">922</span>
                    <span class="line-content">	if not defs then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">923</span>
                    <span class="line-content">		return</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">924</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">925</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">926</span>
                    <span class="line-content">	-- Handle numeric defs by creating an array of &quot;1fr&quot;</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">927</span>
                    <span class="line-content">	if type(defs) == &quot;number&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">928</span>
                    <span class="line-content">		local num = defs</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">929</span>
                    <span class="line-content">		defs = {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">930</span>
                    <span class="line-content">		for i = 1, num do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">931</span>
                    <span class="line-content">			table.insert(defs, &quot;1fr&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">932</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">933</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">934</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">935</span>
                    <span class="line-content">	if #defs == 0 then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">936</span>
                    <span class="line-content">		return</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">937</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">938</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">939</span>
                    <span class="line-content">	self.orientation = rowDefs and &quot;VERTICAL&quot; or &quot;HORIZONTAL&quot;</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">940</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">941</span>
                    <span class="line-content">	local cellConfigs = self.config.cells or {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">942</span>
                    <span class="line-content">	local gap = self:ResolveGap()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">943</span>
                    <span class="line-content">	local padding = self:GetPadding()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">944</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">945</span>
                    <span class="line-content">	-- Parse definitions</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">946</span>
                    <span class="line-content">	local parsedDefs = {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">947</span>
                    <span class="line-content">	local totalFr = 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">948</span>
                    <span class="line-content">	local fixedSize = 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">949</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">950</span>
                    <span class="line-content">	for i, def in ipairs(defs) do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">951</span>
                    <span class="line-content">		if def == &quot;auto&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">952</span>
                    <span class="line-content">			parsedDefs[i] = { type = &quot;auto&quot;, value = 0 }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">953</span>
                    <span class="line-content">		elseif type(def) == &quot;number&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">954</span>
                    <span class="line-content">			parsedDefs[i] = { type = &quot;fixed&quot;, value = def }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">955</span>
                    <span class="line-content">			fixedSize = fixedSize + def</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">956</span>
                    <span class="line-content">		elseif type(def) == &quot;string&quot; and def:find(&quot;px$&quot;) then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">957</span>
                    <span class="line-content">			local val = tonumber(def:match(&quot;^(%d+)&quot;)) or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">958</span>
                    <span class="line-content">			parsedDefs[i] = { type = &quot;fixed&quot;, value = val }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">959</span>
                    <span class="line-content">			fixedSize = fixedSize + val</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">960</span>
                    <span class="line-content">		elseif type(def) == &quot;string&quot; and def:find(&quot;fr$&quot;) then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">961</span>
                    <span class="line-content">			local val = tonumber(def:match(&quot;^(%d+)&quot;)) or 1</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">962</span>
                    <span class="line-content">			parsedDefs[i] = { type = &quot;fr&quot;, value = val }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">963</span>
                    <span class="line-content">			totalFr = totalFr + val</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">964</span>
                    <span class="line-content">		else</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">965</span>
                    <span class="line-content">			-- Default to 1fr</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">966</span>
                    <span class="line-content">			parsedDefs[i] = { type = &quot;fr&quot;, value = 1 }</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">967</span>
                    <span class="line-content">			totalFr = totalFr + 1</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">968</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">969</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">970</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">971</span>
                    <span class="line-content">	-- Create cell frames</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">972</span>
                    <span class="line-content">	for i = 1, #defs do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">973</span>
                    <span class="line-content">		local cell = CreateFrame(&quot;Frame&quot;, nil, self)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">974</span>
                    <span class="line-content">		cell.index = i</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">975</span>
                    <span class="line-content">		cell.def = parsedDefs[i]</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">976</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">977</span>
                    <span class="line-content">		-- INSPECT SUPPORT: Cells are structural, but we want them pickable</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">978</span>
                    <span class="line-content">		cell:EnableMouse(true)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">979</span>
                    <span class="line-content">		if cell.SetMouseClickEnabled then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">980</span>
                    <span class="line-content">			cell:SetMouseClickEnabled(false)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">981</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">982</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">983</span>
                    <span class="line-content">		-- Apply cell-specific background</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">984</span>
                    <span class="line-content">		local cellConfig = cellConfigs[i]</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">985</span>
                    <span class="line-content">		if cellConfig and cellConfig.background then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">986</span>
                    <span class="line-content">			cell.bgTexture = cell:CreateTexture(nil, &quot;BACKGROUND&quot;)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">987</span>
                    <span class="line-content">			cell.bgTexture:SetAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">988</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">989</span>
                    <span class="line-content">			local bgType, values = ResolveBackgroundConfig(cellConfig.background)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">990</span>
                    <span class="line-content">			if bgType == &quot;color&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">991</span>
                    <span class="line-content">				local r, g, b, a = FenUI:GetColor(values.token)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">992</span>
                    <span class="line-content">				cell.bgTexture:SetColorTexture(r, g, b, values.alpha or a)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">993</span>
                    <span class="line-content">			end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">994</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">995</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">996</span>
                    <span class="line-content">		self.cells[i] = cell</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">997</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">998</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">999</span>
                    <span class="line-content">	-- Layout cells on size change</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1000</span>
                    <span class="line-content">	self:SetScript(&quot;OnSizeChanged&quot;, function()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1001</span>
                    <span class="line-content">		self:LayoutCells()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1002</span>
                    <span class="line-content">	end)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1003</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1004</span>
                    <span class="line-content">	-- Initial layout</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1005</span>
                    <span class="line-content">	self:LayoutCells()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1006</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1007</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1008</span>
                    <span class="line-content">--- Alias for LayoutCells</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1009</span>
                    <span class="line-content">function LayoutMixin:UpdateLayout()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1010</span>
                    <span class="line-content">	self:LayoutCells()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1011</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1012</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1013</span>
                    <span class="line-content">function LayoutMixin:LayoutCells()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1014</span>
                    <span class="line-content">	if #self.cells == 0 then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1015</span>
                    <span class="line-content">		return</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1016</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1017</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1018</span>
                    <span class="line-content">	local p = self:GetPadding()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1019</span>
                    <span class="line-content">	local gap = self:ResolveGap()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1020</span>
                    <span class="line-content">	local isVertical = self.orientation == &quot;VERTICAL&quot;</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1021</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1022</span>
                    <span class="line-content">	local totalSize = isVertical and (self:GetHeight() - (p.top + p.bottom)) or (self:GetWidth() - (p.left + p.right))</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1023</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1024</span>
                    <span class="line-content">	local totalGaps = gap * (#self.cells - 1)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1025</span>
                    <span class="line-content">	local availableSize = totalSize - totalGaps</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1026</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1027</span>
                    <span class="line-content">	-- Calculate fixed and fr sizes</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1028</span>
                    <span class="line-content">	local fixedSize = 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1029</span>
                    <span class="line-content">	local totalFr = 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1030</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1031</span>
                    <span class="line-content">	for _, cell in ipairs(self.cells) do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1032</span>
                    <span class="line-content">		if cell.def.type == &quot;fixed&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1033</span>
                    <span class="line-content">			fixedSize = fixedSize + cell.def.value</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1034</span>
                    <span class="line-content">		elseif cell.def.type == &quot;fr&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1035</span>
                    <span class="line-content">			totalFr = totalFr + cell.def.value</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1036</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1037</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1038</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1039</span>
                    <span class="line-content">	local frSize = totalFr &gt; 0 and (availableSize - fixedSize) / totalFr or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1040</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1041</span>
                    <span class="line-content">	-- Position cells</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1042</span>
                    <span class="line-content">	local offset = isVertical and p.top or p.left</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1043</span>
                    <span class="line-content">	for i, cell in ipairs(self.cells) do</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1044</span>
                    <span class="line-content">		local cellSize</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1045</span>
                    <span class="line-content">		if cell.def.type == &quot;fixed&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1046</span>
                    <span class="line-content">			cellSize = cell.def.value</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1047</span>
                    <span class="line-content">		elseif cell.def.type == &quot;fr&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1048</span>
                    <span class="line-content">			cellSize = frSize * cell.def.value</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1049</span>
                    <span class="line-content">		else</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1050</span>
                    <span class="line-content">			cellSize = frSize -- auto defaults to 1fr for now</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1051</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1052</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1053</span>
                    <span class="line-content">		cell:ClearAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1054</span>
                    <span class="line-content">		if isVertical then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1055</span>
                    <span class="line-content">			cell:SetPoint(&quot;TOPLEFT&quot;, p.left, -offset)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1056</span>
                    <span class="line-content">			cell:SetPoint(&quot;TOPRIGHT&quot;, -p.right, -offset)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1057</span>
                    <span class="line-content">			cell:SetHeight(math.max(1, cellSize))</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1058</span>
                    <span class="line-content">		else</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1059</span>
                    <span class="line-content">			cell:SetPoint(&quot;TOPLEFT&quot;, offset, -p.top)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1060</span>
                    <span class="line-content">			cell:SetPoint(&quot;BOTTOMLEFT&quot;, offset, p.bottom)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1061</span>
                    <span class="line-content">			cell:SetWidth(math.max(1, cellSize))</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1062</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1063</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1064</span>
                    <span class="line-content">		offset = offset + cellSize + gap</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1065</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1066</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1067</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1068</span>
                    <span class="line-content">--- Get a cell by index</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1069</span>
                    <span class="line-content">---@param index number Cell index (1-based)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1070</span>
                    <span class="line-content">---@return Frame|nil</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1071</span>
                    <span class="line-content">function LayoutMixin:GetCell(index)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1072</span>
                    <span class="line-content">	return self.cells[index]</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1073</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1074</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1075</span>
                    <span class="line-content">--- Set content for a specific cell</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1076</span>
                    <span class="line-content">---@param index number|table Cell index or {row, col}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1077</span>
                    <span class="line-content">---@param col number|nil Column index (if index is row)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1078</span>
                    <span class="line-content">---@param frame Frame Frame to place in cell</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1079</span>
                    <span class="line-content">function LayoutMixin:SetCellContent(index, col, frame)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1080</span>
                    <span class="line-content">	-- If called as (row, col, frame)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1081</span>
                    <span class="line-content">	if frame then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1082</span>
                    <span class="line-content">		-- In 1D layout, we just use the index if col is 1 or nil</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1083</span>
                    <span class="line-content">		-- This is a compatibility shim for tests expecting 2D</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1084</span>
                    <span class="line-content">		local cell = self:GetCell(index)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1085</span>
                    <span class="line-content">		if cell then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1086</span>
                    <span class="line-content">			frame:SetParent(cell)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1087</span>
                    <span class="line-content">			frame:ClearAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1088</span>
                    <span class="line-content">			frame:SetAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1089</span>
                    <span class="line-content">			frame:Show()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1090</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1091</span>
                    <span class="line-content">		return</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1092</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1093</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1094</span>
                    <span class="line-content">	-- If called as (index, frame)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1095</span>
                    <span class="line-content">	frame = col</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1096</span>
                    <span class="line-content">	local cell = self:GetCell(index)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1097</span>
                    <span class="line-content">	if cell then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1098</span>
                    <span class="line-content">		frame:SetParent(cell)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1099</span>
                    <span class="line-content">		frame:ClearAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1100</span>
                    <span class="line-content">		frame:SetAllPoints()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1101</span>
                    <span class="line-content">		frame:Show()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1102</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1103</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1104</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1105</span>
                    <span class="line-content">--- Resolve gap value</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1106</span>
                    <span class="line-content">---@return number</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1107</span>
                    <span class="line-content">function LayoutMixin:ResolveGap()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1108</span>
                    <span class="line-content">	local gap = self.config.gap</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1109</span>
                    <span class="line-content">	if type(gap) == &quot;string&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1110</span>
                    <span class="line-content">		return FenUI:GetSpacing(gap)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1111</span>
                    <span class="line-content">	elseif type(gap) == &quot;number&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1112</span>
                    <span class="line-content">		return gap</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1113</span>
                    <span class="line-content">	elseif type(gap) == &quot;table&quot; then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1114</span>
                    <span class="line-content">		return gap.row or 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1115</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1116</span>
                    <span class="line-content">	return 0</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1117</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1118</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1119</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1120</span>
                    <span class="line-content">-- Animation &amp; Transitions</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1121</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1122</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1123</span>
                    <span class="line-content">function LayoutMixin:SetupLifecycleAnimations()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1124</span>
                    <span class="line-content">	local config = self.config</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1125</span>
                    <span class="line-content">	local showAnim = config.showAnimation</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1126</span>
                    <span class="line-content">	local hideAnim = config.hideAnimation</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1127</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1128</span>
                    <span class="line-content">	if showAnim then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1129</span>
                    <span class="line-content">		local anim = type(showAnim) == &quot;string&quot; and FenUI.Animation.Presets[showAnim] or FenUI.Animation:Define(showAnim)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1130</span>
                    <span class="line-content">		if anim then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1131</span>
                    <span class="line-content">			self:HookScript(&quot;OnShow&quot;, function()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1132</span>
                    <span class="line-content">				anim:Play(self)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1133</span>
                    <span class="line-content">			end)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1134</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1135</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1136</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1137</span>
                    <span class="line-content">	if hideAnim then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1138</span>
                    <span class="line-content">		local anim = type(hideAnim) == &quot;string&quot; and FenUI.Animation.Presets[hideAnim] or FenUI.Animation:Define(hideAnim)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1139</span>
                    <span class="line-content">		if anim then</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1140</span>
                    <span class="line-content">			local originalHide = self.Hide</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1141</span>
                    <span class="line-content">			self.Hide = function(this)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1142</span>
                    <span class="line-content">				anim:Play(this, {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1143</span>
                    <span class="line-content">					onComplete = function()</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1144</span>
                    <span class="line-content">						originalHide(this)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1145</span>
                    <span class="line-content">					end,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1146</span>
                    <span class="line-content">				})</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1147</span>
                    <span class="line-content">			end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1148</span>
                    <span class="line-content">		end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1149</span>
                    <span class="line-content">	end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1150</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1151</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1152</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1153</span>
                    <span class="line-content">-- Factory</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1154</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1155</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1156</span>
                    <span class="line-content">--- Create a layout container</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1157</span>
                    <span class="line-content">---@param parent Frame Parent frame</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1158</span>
                    <span class="line-content">---@param config table Configuration</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1159</span>
                    <span class="line-content">---@return Frame layout</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1160</span>
                    <span class="line-content">function FenUI:CreateLayout(parent, config)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1161</span>
                    <span class="line-content">	config = config or {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1162</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1163</span>
                    <span class="line-content">	-- NOTE: Don&#x27;t use BackdropTemplate when using NineSlice</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1164</span>
                    <span class="line-content">	-- NineSlice and BackdropTemplate conflict in WoW 9.1.5+.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1165</span>
                    <span class="line-content">	-- We use a dedicated bgFrame child at frameLevel 0 for backgrounds instead.</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1166</span>
                    <span class="line-content">	local layout = CreateFrame(&quot;Frame&quot;, config.name, parent or UIParent)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1167</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1168</span>
                    <span class="line-content">	-- Apply mixin</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1169</span>
                    <span class="line-content">	FenUI.Mixin(layout, LayoutMixin)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1170</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1171</span>
                    <span class="line-content">	-- Initialize</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1172</span>
                    <span class="line-content">	layout:Init(config)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1173</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1174</span>
                    <span class="line-content">	return layout</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1175</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1176</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1177</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1178</span>
                    <span class="line-content">-- Convenience Aliases</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1179</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1180</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1181</span>
                    <span class="line-content">--- Create a card container (subtle border + optional shadow)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1182</span>
                    <span class="line-content">---@param parent Frame Parent frame</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1183</span>
                    <span class="line-content">---@param config table Configuration</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1184</span>
                    <span class="line-content">---@return Frame card</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1185</span>
                    <span class="line-content">function FenUI:CreateCard(parent, config)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1186</span>
                    <span class="line-content">	config = config or {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1187</span>
                    <span class="line-content">	return self:CreateLayout(parent, {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1188</span>
                    <span class="line-content">		width = config.width,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1189</span>
                    <span class="line-content">		height = config.height,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1190</span>
                    <span class="line-content">		border = config.border or &quot;Inset&quot;, -- Use our custom Inset border pack</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1191</span>
                    <span class="line-content">		background = config.background or &quot;surfaceInset&quot;, -- Use inset (recessed) background</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1192</span>
                    <span class="line-content">		shadow = config.shadow,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1193</span>
                    <span class="line-content">		padding = config.padding or 0,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1194</span>
                    <span class="line-content">		paddingTop = config.paddingTop,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1195</span>
                    <span class="line-content">		paddingBottom = config.paddingBottom,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1196</span>
                    <span class="line-content">		paddingLeft = config.paddingLeft,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1197</span>
                    <span class="line-content">		paddingRight = config.paddingRight,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1198</span>
                    <span class="line-content">		rows = config.rows,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1199</span>
                    <span class="line-content">		cells = config.cells,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1200</span>
                    <span class="line-content">		gap = config.gap,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1201</span>
                    <span class="line-content">	})</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1202</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1203</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1204</span>
                    <span class="line-content">--- Create a dialog container (Modern border + drop shadow)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1205</span>
                    <span class="line-content">---@param parent Frame Parent frame</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1206</span>
                    <span class="line-content">---@param config table Configuration</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1207</span>
                    <span class="line-content">---@return Frame dialog</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1208</span>
                    <span class="line-content">function FenUI:CreateDialog(parent, config)</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1209</span>
                    <span class="line-content">	config = config or {}</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1210</span>
                    <span class="line-content">	return self:CreateLayout(parent, {</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1211</span>
                    <span class="line-content">		width = config.width or 400,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1212</span>
                    <span class="line-content">		height = config.height or 300,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1213</span>
                    <span class="line-content">		border = config.border or &quot;ModernDark&quot;, -- Use our custom ModernDark border pack</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1214</span>
                    <span class="line-content">		background = config.background or &quot;surfacePanel&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1215</span>
                    <span class="line-content">		shadow = config.shadow or &quot;inner&quot;,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1216</span>
                    <span class="line-content">		padding = config.padding or 0,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1217</span>
                    <span class="line-content">		paddingTop = config.paddingTop,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1218</span>
                    <span class="line-content">		paddingBottom = config.paddingBottom,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1219</span>
                    <span class="line-content">		paddingLeft = config.paddingLeft,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1220</span>
                    <span class="line-content">		paddingRight = config.paddingRight,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1221</span>
                    <span class="line-content">		rows = config.rows,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1222</span>
                    <span class="line-content">		cells = config.cells,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1223</span>
                    <span class="line-content">		gap = config.gap,</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1224</span>
                    <span class="line-content">	})</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1225</span>
                    <span class="line-content">end</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1226</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1227</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1228</span>
                    <span class="line-content">-- Export Mixin</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1229</span>
                    <span class="line-content">--------------------------------------------------------------------------------</span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1230</span>
                    <span class="line-content"></span>
                </div>
        
                <div class="code-line ">
                    <span class="line-number">1231</span>
                    <span class="line-content">FenUI.LayoutMixin = LayoutMixin</span>
                </div>
        
            </div>
        </div>
    
    </div>
</body>
</html>
